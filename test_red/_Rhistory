library(readr)
forensic <- read_csv("C:/Users/ehrlichd/Google Drive/AAPA2017/aapa2017/RED/forensic.csv")
View(forensic)
teeth = forensic
teeth = replace(teeth, 99, "N/A")
teeth = replace(teeth, "99", "N/A")
View(teeth)
is.na(teeth) = 99
is.na(teeth) = "99"
View(teeth)
group = 10
var = 11
library(readr)
forensic <- read_csv("C:/Users/ehrlichd/Google Drive/AAPA2017/aapa2017/RED/forensic.csv",
na = "99")
View(forensic)
teeth2 = attach(forensic2)
teeth2 = attach(forensic)
teeth = (forensic)
group<-10
var<-11
teeth2<-teeth
for(i in 2:ncol(teeth2)) {
for (j in 1:nrow(teeth2)) {
teeth2[j, i] <- teeth[j,i] - mean(teeth[,i], na.rm = TRUE))/(var(teeth[,i], na.rm = TRUE))**.5}}
teeth2 <- teeth for(i in 2:ncol(teeth2)){
for (i in 2:ncol(teeth2)) {
for (j in 1:nrow(teeth2)){
teeth2[j,i] <- (teeth[j,i] - mean(teeth[,i],na.rm = TRUE))/(var(teeth[,i], na.rm = TRUE))**.5
}}
View(teeth2)
new <- (split(teeth2, factor(teeth2[,1])))
g1 = as.data.frame(new$TNAA)
g2 = as.data.frame(new$CAAA)
g3 = as.data.frame(new$NYAA)
g4 = as.data.frame(new$OHEA)
g5 = as.data.frame(new$TNEA)
g6 = as.data.frame(new$NYEA)
g7 = as.data.frame(new$NMHA)
g8 = as.data.frame(new$SFHA)
g9 = as.data.frame(new$CAHA)
g10 = as.data.frame(new$NYHA)
max = max(nrow(g1), nrow(g2), nrow(g3), nrow(g4), nrow(g5), nrow(g6), nrow(g7), nrow(g8), nrow(g9), nrow(g10))
m = array(-100, c(max,group,var))
test = max(nrow(g1))
summary(test)
rm(test)
summary(m)
View(m)
for (i in 2:ncol(teeth2)){
pad<- rep(NA, (max-length(g1[,i])))
g12<- c(g1[,i],pad)
pad <- rep(NA, (max-length(g2[,i])))
g22 <- c(g2, [,i], pad)
for (i in 2:ncol(teeth2)){
pad <- rep(NA, (max-length(g1[,i])))
g12 <- c(g1[,i],pad)
pad <- rep(NA, (max-length(g2[,i])))
g22 <- c(g2[,i],pad)
pad <- rep(NA, (max-length(g3[,i])))
g32 <- c(g3[,i],pad)
pad <- rep(NA, (max-length(g4[,i])))
g42 <- c(g4[,i],pad)
pad <- rep(NA, (max-length(g5[,i])))
g52 <- c(g5[,i],pad)
pad <- rep(NA, (max-length(g6[,i])))
g62 <- c(g6[,i],pad)
pad <- rep(NA, (max-length(g7[,i])))
g72 <- c(g7[,i],pad)
pad <- rep(NA, (max-length(g8[,i])))
g82 <- c(g8[,i],pad)
pad <- rep(NA, (max-length(g9[,i])))
g92 <- c(g9[,i],pad)
pad <- rep(NA, (max-length(g10[,i])))
g102 <- c(g10[,i],pad)
m[,,i-1] <- cbind(g12,g22,g32,g42,g52,g62,g72,g82,g92,g102)
}
store <- array(NA,c(max,max))
View(store)
reset = array(NA, c(max,max))
hl <- array(NA, c(group,group,var))
diss<- matrix(NA,nrow=group, ncol = group)
for (i in 1:var){
for (j in 1:group){
for (k in 1:group){
for (l in 1:max){
for (n in 1:max){
store[n,1] <- m[l,j,i]- m[n,k,i]
if ((n==max) & (l ==max)) {hl[j,k,i] <- mean(store, na.rm = TRUE)}
if ((n==max) & (l==max)) {store<- reset}
}}}}}
for (i in 1:group){
for (j in 1:group) {
diss[j,i] <- abs(mean(hl[j,i,]))
}}
final <- abs(diss)
colnames(final) <- c("TNAA","CAAA","NYAA","OHEA","TNEA","NYEA","NMHA","SFHA","CAHA","NYAA")
library(cluster)
cluster <-agnes(final,diss = "TRUE", method = "ward")
View(diss)
View(final)
View(g3)
View(g12)
View(m)
View(hl)
hl = array(NA, c(group, group, var))
diss = matrix(NA< nrow=group, ncol=group
)
diss = matrix(NA< nrow=group, ncol=group)
diss = matrix(NA, nrow=group, ncol=group)
for (i in 1:var){
for (j in 1:group) {
for (k in 1:group) {
for (l in 1:max){
for (n in 1:max){
store[n,l] <- m[l,j,i]- m[n,k,i]
if ((n==max) & (l==max)) {hl[j,k,i] <-mean(store, na.rm = TRUE)}
if ((n==max) & (l==max)) {store<-reset}
}}}}}
for (i in 1:group){
for (j in 1:group){
diss[j,i] <- abs(mean(hl[j,i]))
}}
for (i in 1:group){
for (j in 1:group){
diss[j,i] <- abs(mean(hl[j,i,]))
}}
View(diss)
final = abs(diss)
colnames(final)<- c("TNAA","CAAA","NYAA","OHEA","TNEA","NYEA","NMHA","CAHA","NYAA")
colnames(final)<- c("TNAA","CAAA","NYAA","OHEA","TNEA","NYEA","NMHA","SFHA", "CAHA","NYAA")
cluster<-agnes(final, diss="TRUE", method ="ward")
plot(cluster)
library(AnthropMMD)
StartMMD()
StartMMD()
library(readr)
symD_mmd <- read_csv("C:/Users/ehrlichd/Google Drive/AAPA2017/aapa2017/symD_mmd.csv")
View(symD_mmd)
mmd = as.dist(symD_mmd)
rm(mmd)
row.names(symD_mmd) = symD_mmd[,1]
MMD = as.dist(symD_mmd[-1])
library(rgl)
plot3d(cmdscale(MMD, k = 3))
3dMMD = cmdscale(MMD, k = 3)
symD_mmd = as.dist(symD_mmd[-1])
MMD = cmdscale(symD_mmd, k = 3)
plot3d(MMD)
plot3d(MMD[,1:3])
plot(MMD[,1:2])
plot3d(MMD[1:3])
View(MMD)
plot3d(MMD[,1:3])
plot3d(MMD[,1:3], type = "s")
plot3d(MMD[,1:3], type = "s", size = 2)
grp = as.data.frame(row.names(MMD))
View(grp)
text3d(x=MMD[,1], y=MMD[,2], z=MMD[,3], texts = grp[,1])
plot3d(MMD[,1:3])
text3d(x=MMD[,1], y=MMD[,2], z=MMD[,3], texts = grp[,1])
plot(hclust(symD_mmd, method = "ward.D"))
library(readr)
RED_dat <- read_csv("C:/Users/ehrlichd/Google Drive/AAPA2017/aapa2017/RED_dat.csv")
View(RED_dat)
attach(RED_dat)
teeth = (RED_dat)
group = 7
var = 17
teeth2 = teeth
for (i in 2:ncol(teeth2)){
for (j in 1:nrow(teeth2)){
teeth2[j,i] = (teeth[j,i]-
mean(teeth[,i],na.rm = TRUE)/(var(teeth[,i],na.rm=TRUE))**.5
}}
for (i in 2:ncol(teeth2)){
for (j in 1:nrow(teeth2)){
teeth2[j,i] = (teeth[j,i]- mean(teeth[,i],na.rm = TRUE))/(var(teeth[,i],na.rm=TRUE))**.5
}}
new = (split(teeth2, factor(teeth2[,1])))
g1 = as.data.frame(new$SF1)
g2 = as.data.frame(new$SF2)
g3 = as.data.frame(new$SF2A)
g4 = as.data.frame(new$SF3)
g5 = as.data.frame(new$SQA)
g6 = as.data.frame(new$SQB)
g7 = as.data.frame(new$SQCD)
max = max(nrow(g1), nrow(g2), nrow(g3), nrow(g4), nrow(g5), nrow(g6),nrow(g7))
m = array(-11, c(max, group, var))
for (i in 2:ncol(teeth2)){
pad<-rep(NA, (max-length(g1[,i])))
g12<- c(g1[,i],pad)
pad<-rep(NA, (max-length(g2[,i])))
g22<- c(g1[,i],pad)
pad<-rep(NA, (max-length(g3[,i])))
g32<- c(g1[,i],pad)
pad<-rep(NA, (max-length(g4[,i])))
g42<- c(g1[,i],pad)
pad<-rep(NA, (max-length(g5[,i])))
g52<- c(g1[,i],pad)
pad<-rep(NA, (max-length(g6[,i])))
g62<- c(g1[,i],pad)
pad<-rep(NA, (max-length(g7[,i])))
g72<- c(g1[,i],pad)
pad<-rep(NA, (max-length(g2[,i])))
g22<- c(g2[,i],pad)
pad<-rep(NA, (max-length(g3[,i])))
g32<- c(g3[,i],pad)
pad<-rep(NA, (max-length(g4[,i])))
g42<- c(g4[,i],pad)
pad<-rep(NA, (max-length(g5[,i])))
g52<- c(g5[,i],pad)
pad<-rep(NA, (max-length(g6[,i])))
g62<- c(g6[,i],pad)
pad<-rep(NA, (max-length(g7[,i])))
g72<- c(g7[,i],pad)
m[,,i-1]<-cbind(g12,g22,g32,g42,g52,g62,g72)
}
store <- array(NA, c(max,max))
reset<- array(NA, c(max,max))
hl<- array(NA, c(group,group,var))
diss<- matrix(NA, nrow=group, ncol=group)
for (i in 1:var){
for (j in 1:group){
for(k in 1:group){
for (l in 1:max){
for (n in 1:max){
store[n,1] <- m[l,j,i] - m[n,k,i]
if ((n==max) & (l==max)) {hl[j,k,l]<-mean(store,na.rm = TRUE)}
if ((n==max) & (l==max)) {store<-reset}
}}}}}
for (i in 1:var){
for (j in 1:group){
for (k in 1:group){
for (l in 1:max){
for (n in 1:max){
store[n,l]<- m[l,j,i]- m[n,k,i]
if ((n==max) & (l==max)) {hl[j,k,i]<-mean(store,na.rm = TRUE)}
if ((n==max) & (l==max)) {store<-reset}
}}}}}
for (i in 1:group){
for (j in 1:group){
diss[j,i]<-abs(mean(hl[j,i,]))
}}
final<-abs(diss)
colnames(final)<-c("SF1","SF2","SF2A","SF3","SQA","SQB","SQCD")
library(cluster)
cluster<-agnes(final,diss = "TRUE", method = "ward")
View(diss)
View(final)
final = final[-SQA]
final = final[-"SQA"]
final = final[-5]
final<-abs(diss)
test = final[-,5]
test = as.data.frame(final)
test = test[-5]
View(test)
colnames(test) = c("SF1","SF2","SF2A","SF3","SQB","SQCD")
rownames(test) = c("SF1","SF2","SF2A","SF3","SQA","SQB","SQCD")
test = subset(test, rownames(test)!="SQA")
cluster = agnes(final, diss = "TRUE", method = "ward")
final = test
cluster = agnes(final, diss = "TRUE", method = "ward")
plot(cluster)
table(cutree(cluster,group),teeth2[,1])
table(cutree(cluster,group),c("SF1","SF2A","SF3","SQB","SQCD"))
table(cutree(cluster,6),c("SF1","SF2A","SF3","SQB","SQCD"))
red1 = cluster
library(readr)
RED_dat_rmA <- read_csv("C:/Users/ehrlichd/Google Drive/AAPA2017/aapa2017/RED_dat_rmA.csv")
View(RED_dat_rmA)
attach(RED_dat_rmA)
teeth<-RED_dat_rmA
group = 6
teeth2 = teeth
for (i in 2:ncol(teeth2)) {
for (j in 1:nrow(teeth2)) {
teeth2[j,i] = (teeth[j,i]) -
mean(teeth[,i],na.rm = TRUE))/(var(teeth[,i],na.rm=TRUE))**.5
for (i in 2:ncol(teeth2)) {
for (j in 1:nrow(teeth2)) {
teeth2[j,i] = (teeth[j,i] -
mean(teeth[,i],na.rm = TRUE))/(var(teeth[,i],na.rm=TRUE))**.5
}}
new = (split(teeth2, factor(teeth2[,1])))
g1 = as.data.frame(new$SF1)
g2 = as.data.frame(new$SF2)
g3 = as.data.frame(new$SF2A)
g4 = as.data.frame(new$SF3)
g5 = as.data.frame(new$SQB)
g6 = as.data.frame(new$SQCD)
rm(g7)
View(group)
max = max(nrow(g1),nrow(g2),nrow(g3),nrow(g4),nrow(g5),nrow(g6))
m = array(-100, c(max,group,var))
for (i in 2:ncol(teeth2)){
pad<-rep(NA, (max-length(g1[,i])))
g12 = c(g1[,i],pad)
pad<-rep(NA, (max-length(g2[,i])))
g22 = c(g2[,i],pad)
pad<-rep(NA, (max-length(g3[,i])))
g32 = c(g3[,i],pad)
pad<-rep(NA, (max-length(g4[,i])))
g42 = c(g4[,i],pad)
pad<-rep(NA, (max-length(g5[,i])))
g52 = c(g5[,i],pad)
pad<-rep(NA, (max-length(g6[,i])))
g62 = c(g6[,i],pad)
rm(g72)
m[,,i-1]<-cbind(g12,g22,g32,g42,g52,g62)
store<-array(NA,c(max,max))
reset(array(NA,c(max,max)))
hl <-array(NA,c(group,group,var))
diss<-matrix(NA,nrow=group,ncol=group)}
for (i in 2:ncol(teeth2)){
pad<-rep(NA, (max-length(g1[,i])))
g12 = c(g1[,i],pad)
pad<-rep(NA, (max-length(g2[,i])))
g22 = c(g2[,i],pad)
pad<-rep(NA, (max-length(g3[,i])))
g32 = c(g3[,i],pad)
pad<-rep(NA, (max-length(g4[,i])))
g42 = c(g4[,i],pad)
pad<-rep(NA, (max-length(g5[,i])))
g52 = c(g5[,i],pad)
pad<-rep(NA, (max-length(g6[,i])))
g62 = c(g6[,i],pad)
m[,,i-1]<-cbind(g12,g22,g32,g42,g52,g62)
}
store<-array(NA,c(max,max))
reset<-array(NA,c(max,max))
hl<-array(NA,c(group,group,var))
diss<-matrix(NA,nrow=group,ncol=group)
for (i in 1:var){
for (j in 1:group){
for (k in 1:group){
for (l in 1:group){
for (n in }}}})
for (i in 1:var){
for (k in 1:group){
for (j in 1:group){
for (l in 1:max){
for (n in 1:max){
store[n,1]<- m[l,j,i]- m[n,k,i]
if ((n==max) & (l==max)) {hl[j,k,i]<-mean(store,na.rm=TRUE) }
if ((n=max) & (l==max)) {store<-reset}
}}}}}
for (i in 1:group){
for(j in 1:group){
diss[j,i]<-abs(mean(hl[j,i,]))
}}
final<-abs(diss)
colnames(final) <-c("SF1","SF2","SF2A","SF3","SQB","SQCD")
cluster = agnes(final, diss="TRUE", method = "ward")
View(final)
for (i in 1:var){
for (j in 1:group){
for (k in 1:group){
for (l in 1:max){
for (n in 1:max){
store[n,l]<- m[l,j,i]- m[n,k,i]
if ((n==max) & (l==max)) {hl[j,k,i]<-mean(store,na.rm = TRUE)}
if ((n==max) & (l==max)) {store<-reset}
}}}}}
for I9 in 1:group){
for (i in 1:group){
for(j in 1:group){
diss[j,i]<-abs(mean(hl[j,i,]))
}}
final = abs(diss)
colnames(final) = c("SF1","SF2","SF2A","SF3","SQB","SQCD")
cluster<- agnes(final,diss="TRUE", method="ward")
plot(cluster)
rm(RED_dat)
rm(red1)
RED = final
MDSRED = cmdscale(RED, k = 3)
library(rgl)
plot3d(MDSRED, type ="s",size ="1")
plot3d(MDSRED, type ="s",size =1)
plot3d(MDSRED)
plot3d(MDSRED, type ="s",size = 2)
text3d(x = MDSRED[,1], y = MDSRED[,2], z=MDSRED[,3], texts = colnames(final))
text3d(x = MDSRED[,1], y = MDSRED[,2], z=MDSRED[,3], texts = colnames(final), adj = c(2,1))
lbl1 = as.list(colnames(final))
lbl2 = as.list(c("Red","Red","Red","red","Blue","Blue"))
lbl = as.data.frame(cbind(lbl1,lbl2))
View(lbl)
plot3d(MDSRED, type ="s",size = 2, col = lbl$lbl2)
text3d(x = MDSRED[,1], y = MDSRED[,2], z=MDSRED[,3], texts = colnames(final), adj = c(2,1))
plot3d(MDSRED, type ="s",size = 2, col = lbl$lbl2)
plot3d(MDSRED, type ="s",size = 2, col = lbl$lbl2)
View(rgl.dev.list())
rgl.dev.list()
plot3d(MDSRED)
plot3d(MDSRED, type ="s",size = 2, col = lbl$lbl2)
text3d(x = MDSRED[,1], y = MDSRED[,2], z=MDSRED[,3], texts = colnames(final), adj = c(2,1))
library(AnthropMMD)
StartMMD()
library(readr)
MMD_sym <- read_csv("C:/Users/ehrlichd/Google Drive/AAPA2017/aapa2017/MMD_sym.csv")
View(MMD_sym)
row.names(MMD_sym)=MMD_sym[,1]
MMD_sym = MMD_sym[-1]
MMD = as.dist(MMD_sym)
MDSMMD = cmdscale(MMD, k = 3)
plot(hclust(MMD_sym, method = "ward.D")
)
View(MMD_sym)
MMD_sym = as.dist(MMD_sym)
plot(hclust(MMD_sym, method = "ward.D")
)
plot3d(MMD, type="s",size = 2, col = lbl$lbl2)
plot3d(MMD)
plot3d(MDSMMD, type="s",size = 2, col = lbl$lbl2)
text3d(x = MDSMMD[,1], y = MDSMMD[,2], z=MDSMMD[,3], texts = colnames(final), adj = c(2,1))
View(MDSMMD)
StartMMD()
library(readr)
MMD_sym <- read_csv("C:/Users/ehrlichd/Google Drive/AAPA2017/aapa2017/MMD_sym.csv")
View(MMD_sym)
row.names(MMD_sym) = MMD_sym[,1]
View(MMD_sym)
MMD_sym = MMD_sym[-1]
View(MMD_sym)
help("AnthropMMD")
help("AnthropMMD-package")
MMD = as.dist(MMD_sym)
MDSMMD = cmdscale(MMD, k = 3)
plot(hclust(MMD, method = "ward.D"))
plot(hclust(MMD, method = "ward.D2"))
plot3d(MDSMMD, type="s",size = 2, col = lbl$lbl2)
text3d(x = MDSMMD[,1], y = MDSMMD[,2], z=MDSMMD[,3], texts = colnames(final), adj = c(2,1))
plot3d(MDSMMD, type="h", add=TRUE)
plot3d(MDSMMD, type="s",size = 2, col = lbl$lbl2)
plot3d(MDSMMD, type="s",size = 2, col = lbl$lbl2, xlab = "", ylab = "", zlab = "")
text3d(x = MDSMMD[,1], y = MDSMMD[,2], z=MDSMMD[,3], texts = colnames(final), adj = c(2,1))
text3d(x = MDSMMD[,1], y = MDSMMD[,2], z=MDSMMD[,3], texts = colnames(final), adj = c(1,1))
plot3d(MDSMMD, type="s",size = 2, col = lbl$lbl2, xlab = "", ylab = "", zlab = "")
text3d(x = MDSMMD[,1], y = MDSMMD[,2], z=MDSMMD[,3], texts = colnames(final), adj = c(1.5,1))
plot3d(MDSRED, type="s",size = 2, col = lbl$lbl2, xlab = "", ylab = "", zlab = "")
plot3d(MDSRED)
plot3d(MDSRED, type="s",size = 2, col = lbl$lbl2, xlab = "", ylab = "", zlab = "")
text3d(x = MDSMMD[,1], y = MDSMMD[,2], z=MDSMMD[,3], texts = colnames(final), adj = c(1.5,1))
plot3d(MDSRED)
plot3d(MDSRED, type="s",size = 2, col = lbl$lbl2, xlab = "", ylab = "", zlab = "")
text3d(x = MDSRED[,1], y = MDSRED[,2], z=MDSRED[,3], texts = colnames(final), adj = c(1.5,1))
l3 = c("Blue Rock","Lancaster","Mohr","Funk","Early SQ","Late SQ")
lbl = cbind(lbl,l3)
View(lbl)
colnames(lbl) = c("lbl","col","name")
View(lbl)
plot3d(MDSRED, type="s",size = 2, col = lbl$lbl2, xlab = "", ylab = "", zlab = "")
plot3d(MDSRED, type="s",size = 2, col = lbl$col xlab = "", ylab = "", zlab = "")
plot3d(MDSRED, type="s",size = 2, col = lbl$col, xlab = "", ylab = "", zlab = "")
text3d(x = MDSRED[,1], y = MDSRED[,2], z=MDSRED[,3], texts = lbl$name, adj = c(1.5,1))
plot3d(MDSMMD, type="s",size = 2, col = lbl$col, xlab = "", ylab = "", zlab = "")
text3d(x = MDSMMD[,1], y = MDSMMD[,2], z=MDSMMD[,3], texts = lbl$name, adj = c(1.5,1))
plot(hclust(MMD, method = "ward.D"))
plot(hclust(MMD, method = "ward.D2"))
row.names(MMD) = lbl$name
row.names(MMD) = lbl[,3]
plot(hclust(MMD, method = "ward.D"), leaflab = "none")
plot(as.dendrogram(hclust(MMD, method = "ward.D"), leaflab = "none")
)
plot(hclust(MMD, method = "ward.D"))
MMDden = hclust(MMD, method = "ward.D")
MMDden = as.dendrogram(MMDden, leaflab = "none")
plot(MMDden)
MMDden = as.dendrogram(MMDden, leaflab = "")
plot(MMDden)
plot(MMD, method = "ward.D")
plot(hclust(MMD, method = "ward.D")
)
warnings()
plot(hclust(MMD, method = "ward.D"), hang = 0)
plot(hclust(MMD, method = "ward.D"), hang = .1)
plot(hclust(MMD, method = "ward.D"), hang = 1)
plot(hclust(MMD, method = "ward.D"), hang = .01)
plot(hclust(MMD, method = "ward.D"), hang = .5)
plot(hclust(MMD, method = "ward.D"))
library(rgl)
plot3d(MMD, type = "s", size = 2, col = lbl$col)
plot3d(MMD)
plot3d(MDSMMD, type = "s", size = 2, col = lbl$col)
plot3d(MDSRED, type = "s", size = 2, col = lbl$col)
plot3d(MDSRED)
plot3d(MDSRED, type = "s", size = 2, col = lbl$col)
text3d(MDSRED[,1],MDSRED[,2],MDSRED[,3], texts = lbl$name, adj = c(1.5,1))
